!function(){"use strict";function t(t,e,n,i){return new(n||(n=Promise))((function(e,s){function o(t){try{h(i.next(t))}catch(t){s(t)}}function r(t){try{h(i.throw(t))}catch(t){s(t)}}function h(t){t.done?e(t.value):new n((function(e){e(t.value)})).then(o,r)}h((i=i.apply(t,[])).next())}))}function e(){}function n(t){return new Promise(e=>{setTimeout(()=>{e()},t)})}function i(){return+new Date}function s(t){return e=>e<=0?0:e>=1?1:t(e)}const o=s(t=>t),r=s(t=>(Math.sin((t-.5)*Math.PI)+1)/2),h=s(t=>Math.sin((t-1)*Math.PI/2)+1),a=s(t=>1-Math.pow(2,-10*t));function d(t,e,n){return t*(n-e)+e}class c{constructor(t={}){this.colorAnimId=-1,this.red=0,this.green=0,this.blue=0,this.alpha=0,this.updateColor=e,this.setColor(t)}getString(){this.updateColor();const{red:t,green:e,blue:n,alpha:i}=this;return`rgba(${t}, ${e}, ${n}, ${i})`}toString(){return this.getString()}setColor(t){this.updateColor=l(t)}animateColor(e,n,i){return t(this,0,void 0,(function*(){yield this.animateUpdateColor(l(e),n,i)}))}animateUpdateColor(e,s=400,o=r){return t(this,0,void 0,(function*(){clearTimeout(this.colorAnimId);const t=this.updateColor,r=i();this.updateColor=function(){const n=o((i()-r)/s);t.call(this);const{red:h,green:a,blue:c,alpha:l}=this;e.call(this);const{red:u,green:p,blue:f,alpha:w}=this;this.red=d(n,h,u),this.green=d(n,a,p),this.blue=d(n,c,f),this.alpha=d(n,l,w)},this.colorAnimId=setTimeout(()=>{this.updateColor=e},s),yield n(s)}))}}function l(t){if("string"==typeof t){if("#"===(t=t.trim())[0]){const e=t.substring(1),n=parseInt(e,16);let i,s,o,r;switch(e.length){case 3:i=17*(n>>8&15),s=17*(n>>4&15),o=17*(n>>0&15),r=1;break;case 4:i=17*(n>>12&15),s=17*(n>>8&15),o=17*(n>>4&15),r=(n>>0&15)/15;break;case 6:i=n>>16&255,s=n>>8&255,o=n>>0&255,r=1;break;case 8:i=n>>24&255,s=n>>16&255,o=n>>8&255,r=(n>>0&255)/255}return function(){this.red=i,this.green=s,this.blue=o,this.alpha=r}}throw new Error("unable to parse "+t)}const{updateColor:e}=t;if(void 0!==e)return e;const{red:n,green:i,blue:s,alpha:o}=t;return function(){this.red=null!=n?n:255,this.green=null!=i?i:255,this.blue=null!=s?s:255,this.alpha=null!=o?o:1}}class u{constructor(){this.handlers=new Map}getHandler(t){const e=this.handlers;let n=e.get(t);return void 0===n&&e.set(t,n=[]),n}on(t,e){this.getHandler(t).push(e)}once(t,e){return new Promise(n=>{const i=()=>{this.off(t,i),e&&e.call(this),n()};this.on(t,i)})}off(t,e){const n=this.getHandler(t),i=n.indexOf(e);i>=0&&n.splice(i,1)}invoke(t){const e=this.getHandler(t);for(const t of e)t.call(this)}}class p extends u{constructor(t={}){var n,i,s,o,r;super(),this._z=0,this.boundAnimId=-1,this.opacityAnimId=-1,this.visible=!0,this.opacity=1,this.x=0,this.y=0,this.width=0,this.height=0,this.children=[],this.parent=null,this.scene=null,this.updateBound=e,this.updateOpacity=e,this.setOpacity(t),this.setBound(t),this.z=null!==(n=t.z)&&void 0!==n?n:0,this.operation=null!==(i=t.operation)&&void 0!==i?i:"source-over",this.entranceParent=null!==(s=t.entranceParent)&&void 0!==s?s:null,this.enterOption=null!==(o=t.enterOption)&&void 0!==o?o:null,this.exitOption=null!==(r=t.exitOption)&&void 0!==r?r:null;const{parent:h}=t;h&&this.addTo(h)}get z(){return this._z}set z(t){this._z=t;const{parent:e}=this;e&&e.updateDrawOrder()}setBound(t){this.updateBound=f(t)}animateBound(e,n,i){return t(this,0,void 0,(function*(){yield this.animateUpdateBound(f(e),n,i)}))}animateUpdateBound(e,s=400,o=r){return t(this,0,void 0,(function*(){clearTimeout(this.boundAnimId);const t=this.updateBound,r=i();this.updateBound=function(){const n=o((i()-r)/s);t.call(this);const{x:h,y:a,width:c,height:l}=this;e.call(this);const{x:u,y:p,width:f,height:w}=this;this.x=d(n,h,u),this.y=d(n,a,p),this.width=d(n,c,f),this.height=d(n,l,w)},this.boundAnimId=setTimeout(()=>{this.updateBound=e},s),yield n(s)}))}setOpacity(t){this.updateOpacity=w(t)}animateOpacity(e,n,i){return t(this,0,void 0,(function*(){yield this.animateUpdateOpacity(w(e),n,i)}))}animateUpdateOpacity(e,s=400,o=r){return t(this,0,void 0,(function*(){clearTimeout(this.opacityAnimId);const t=this.updateOpacity,r=i();this.updateOpacity=function(){const n=o((i()-r)/s);t.call(this);const{opacity:h}=this;e.call(this);const{opacity:a}=this;this.opacity=d(n,h,a)},this.opacityAnimId=setTimeout(()=>{this.updateOpacity=e},s),yield n(s)}))}fadeIn(){return t(this,0,void 0,(function*(){const{entranceParent:t}=this;t&&(this.addTo(t),this.setOpacity(0),yield this.animateOpacity(1,400))}))}fadeOut(){return t(this,0,void 0,(function*(){yield this.animateOpacity(0,200),this.remove()}))}enter(){return t(this,0,void 0,(function*(){const{entranceParent:t,enterOption:e,exitOption:n}=this;t&&e&&n&&(this.addTo(t),this.setBound(n),yield this.animateBound(e,400,a))}))}exit(){return t(this,0,void 0,(function*(){const{exitOption:t}=this;t&&(yield this.animateBound(t,200,h),this.remove())}))}forEachDescendant(t,e=!1){e&&t(this);for(const e of this.children)e.forEachDescendant(t,!0)}updateDrawOrder(t=!1){const{children:e}=this;if(e.sort((t,e)=>t.z-e.z),t)for(const t of e)t.updateDrawOrder(!0)}draw(t,e=!0){this.visible&&(this.updateOpacity(),t.globalAlpha=this.opacity,t.globalCompositeOperation=this.operation,e&&this.drawChildren(t))}drawChildren(t){for(const e of this.children)e.draw(t)}setscene(t){this.scene=t;for(const e of this.children)e.setscene(t)}addChild(t,e=!0){t.invoke("beforeadd"),t.remove(!1),t.parent=this,t.setscene(this.scene),this.children.push(t),e&&this.updateDrawOrder(),t.invoke("afteradd")}addChildren(t,e=!0){for(const e of t)this.addChild(e,!1);e&&this.updateDrawOrder()}addTo(t,e=!0){t.addChild(this,e)}removeChild(t,e=!0){if(t.parent!==this)return;t.invoke("beforeremove"),t.parent=null,e&&t.setscene(null);const{children:n}=this;n.splice(n.indexOf(t),1),t.invoke("afterremove")}remove(t=!0){const{parent:e}=this;e&&e.removeChild(this,t)}removeChildren(t){for(const e of t)this.removeChild(e)}removeAllChildren(){this.removeChildren([...this.children])}hitTest(t,e){this.updateBound();const{x:n,y:i,width:s,height:o}=this;return t>n&&e>i&&t<n+s&&e<i+o}}function f(t){const{updateBound:e}=t;if(e)return e;const{x:n=0,y:i=0,width:s=0,height:o=0,isPositionRelative:r=!0,isScaleRelative:h=!0}=t;return function(){const{parent:t}=this;let e,a,d,c;t?(t.updateBound(),e=r?t.x:0,a=r?t.y:0,d=h?t.width:1,c=h?t.height:1):(e=0,a=0,d=1,c=1),this.x=e+d*n,this.y=a+c*i,this.width=d*s,this.height=c*o}}function w(t){"number"==typeof t&&(t={opacity:t});const{updateOpacity:e}=t;if(e)return e;const{opacity:n=1,isOpacityRelative:i=!0}=t;return function(){const{parent:t}=this;t&&i?(t.updateOpacity(),this.opacity=n*t.opacity):this.opacity=n}}class g extends p{constructor(t={}){super(t),this._dashSpeed=0,this._dash=[],this.thickness=0,this.dashStartOffset=0,this.dashStartTime=i(),this.updateThickness=e,this.dashSum=0;const{fill:n,line:s,cap:o,join:r,dash:h,dashSpeed:a}=t;this.fill=n instanceof c?n:new c(null!=n?n:"#0000"),this.line=s instanceof c?s:new c(null!=s?s:"#0000"),this.cap=null!=o?o:"butt",this.join=null!=r?r:"miter",this.dash=null!=h?h:[],this.dashSpeed=null!=a?a:0,this.setThickness(t)}setThickness(t){this.updateThickness=function(t){if("number"==typeof t)return function(){this.thickness=t};const{updateThickness:e}=t;if(e)return e;const{thickness:n=2}=t;return function(){this.thickness=n}}(t)}get dash(){return this._dash}set dash(t){this._dash=t;let e=0;for(const n of t)e+=n;this.dashSum=e}get dashSpeed(){return this._dashSpeed}set dashSpeed(t){this._dashSpeed=t,this.dashStartOffset=this.getDashOffset(),this.dashStartTime=i()}getDashOffset(){return((i()-this.dashStartTime)*this._dashSpeed+this.dashStartOffset)%this.dashSum}draw(t,e=!0){if(!this.visible)return;super.draw(t,!1),this.updateThickness();const{fill:n,line:i,cap:s,join:o,thickness:r,dash:h}=this;t.fillStyle=n.getString(),t.strokeStyle=i.getString(),t.lineCap=s,t.lineJoin=o,t.lineWidth=r,t.setLineDash(h.map(t=>t*r)),t.lineDashOffset=this.getDashOffset()*r,e&&this.drawChildren(t)}}class m extends g{constructor(t={}){super(t),this.coordsAnimId=-1,this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.updateCoords=e,this.setCoords(t)}setCoords(t){this.updateCoords=y(t)}animateCoords(e,n,i){return t(this,0,void 0,(function*(){yield this.animateUpdateCoords(y(e),n,i)}))}animateUpdateCoords(e,s=400,o=r){return t(this,0,void 0,(function*(){clearTimeout(this.coordsAnimId);const t=this.updateCoords,r=i();this.updateCoords=function(){const n=o((i()-r)/s);t.call(this);const{x0:h,y0:a,x1:c,y1:l}=this;e.call(this);const{x0:u,y0:p,x1:f,y1:w}=this;this.x0=d(n,h,u),this.y0=d(n,a,p),this.x1=d(n,c,f),this.y1=d(n,l,w)},this.coordsAnimId=setTimeout(()=>{this.updateCoords=e},s),yield n(s)}))}draw(t,e=!0){if(!this.visible)return;super.draw(t,!1),this.updateCoords();const{x0:n,y0:i,x1:s,y1:o}=this;t.beginPath(),t.moveTo(n,i),t.lineTo(s,o),t.stroke(),e&&this.drawChildren(t)}}function y(t){const{updateCoords:e}=t;if(e)return e;const{x0:n=0,y0:i=0,x1:s=0,y1:o=0}=t;return function(){this.updateBound();const{x:t,y:e,width:r,height:h}=this;this.x0=t+r*n,this.y0=e+h*i,this.x1=t+r*s,this.y1=e+h*o}}class x extends m{constructor(t={}){super(t),this.setCoords({x0:0,y0:.5,x1:1,y1:.5})}}class v extends p{constructor(t){super(t);const{ratio:e}=t;this.updateBound=function(){const{parent:t}=this;if(!t)return;const{x:n,y:i,width:s,height:o}=t,r=Math.min(s/e,o),h=r*e;this.x=n+(s-h)/2,this.y=i+(o-r)/2,this.width=h,this.height=r}}}class C{constructor(t){this.playing=!0;const e=()=>{this.playing&&(t(),requestAnimationFrame(e))};requestAnimationFrame(e)}stop(){this.playing=!1}}class S extends g{draw(t,e=!0){if(!this.visible)return;super.draw(t,!1),this.updateBound();const{x:n,y:i,width:s,height:o}=this;t.fillRect(n,i,s,o),t.strokeRect(n,i,s,o),e&&this.drawChildren(t)}}const T=new c("#fff"),b=new c("#000"),R=new c("#0038a8"),k=new c("#0000"),P=new c("#fff"),Y=new c("#000"),O=new c("#0038a8"),N=new c("#0f5fff"),L=new c("#ce1126"),B=new c("#fdc116"),K=document.querySelector("canvas"),M=new class extends p{constructor(t){var e,n;super(t),this.scene=this;const i=this.scale=null!==(e=t.scale)&&void 0!==e?e:1,s=this.canvas=t.canvas;t.autoresize&&(this.updateBound=function(){this.x=0,this.y=0,this.width=s.clientWidth*i,this.height=s.clientHeight*i});const o=s.getContext("2d",{alpha:null===(n=t.alpha)||void 0===n||n});if(!o)throw new Error("canvas rendering context not supporteed");this.context=o,o.imageSmoothingEnabled=!0,this.frame=new C(()=>{this.draw(this.context),this.invoke("frame")});const r=["click","mouseup","mousedown","mousemove"],h=["touchstart","touchend"];for(const t of r)s.addEventListener(t,e=>{e.preventDefault();const{pageX:n,pageY:s}=e;this.forEachDescendant(e=>{e.hitTest(n*i,s*i)&&(e.invoke(t),"mousedown"===t&&e.invoke("interactdown"),"mouseup"===t&&e.invoke("interactup"))})});s.addEventListener("touchmove",t=>{t.preventDefault()});for(const t of h)s.addEventListener(t,e=>{e.preventDefault();const n=Array.from(e.changedTouches);this.forEachDescendant(e=>{n.some(t=>e.hitTest(t.pageX*i,t.pageY*i))&&("touchstart"===t&&e.invoke("interactdown"),"touchend"===t&&e.invoke("interactup"))})})}draw(t,e=!0){if(!this.visible)return;super.draw(t,!1),this.updateBound();const{canvas:n,width:i,height:s}=this;n.width=i,n.height=s,t.clearRect(0,0,i,s),e&&this.drawChildren(t)}}({canvas:K,autoresize:!0});new S({x:0,y:0,width:1,height:1,z:2,fill:T,operation:"destination-over",parent:M});const W=new v({ratio:.6,parent:M});function D(){this.thickness=W.width/100}const I=new x({cap:"butt",join:"miter",line:b,dash:[4,4],dashSpeed:.01,updateThickness:D,entranceParent:W,enterOption:{x:2/6,y:.8,width:2/6,height:.2},exitOption:{x:2/6,y:1,width:2/6,height:.2}});function z(e,n){return t(this,0,void 0,(function*(){return yield e,n}))}function A(e){return t(this,0,void 0,(function*(){yield e}))}const _=/\s+/,H=/\r\n|\r|\n/;function E(t){return new Set(G(t))}function G(t){return t.trim().split(_)}class ${constructor(t){this.assets=new Map,this.allLoaded=!1;const e=[];for(const n of t){const t=this.load(n);t.then(t=>{this.assets.set(n,t)}),e.push(t)}this.promise=A(Promise.all(e)),this.promise.then(()=>{this.allLoaded=!0})}get(t){if(!this.allLoaded)throw new Error("Assets not yet loaded");const e=this.assets.get(t);if(null==e)throw new Error(`Reached supposedly unreachable code: ${t} isn't preloaded.`);return e}}const U=new class extends ${load(t){return new Promise((e,n)=>{const i=new Image;i.src=t,i.addEventListener("load",()=>{e(i)}),i.addEventListener("error",()=>{n("Unable to load image from "+t)})})}}(["/asset/title.png","/asset/title_dark.png","/asset/bulb.png"].slice()),j=new class extends ${load(e){return t(this,0,void 0,(function*(){return G(yield function(e){return t(this,0,void 0,(function*(){return new Promise((t,n)=>{const i=new XMLHttpRequest;i.addEventListener("load",()=>{200===i.status?t(i.responseText):n(i.status)}),i.addEventListener("error",()=>{n()}),i.open("GET",e),i.send()})}))}(e))}))}}(["/asset/word_3.txt","/asset/word_4.txt","/asset/word_5.txt","/asset/word_6.txt"].slice()),F=new class extends ${load(t){return new Promise((e,n)=>{const i=new Audio(t);i.addEventListener("canplaythrough",()=>{e(i)}),i.addEventListener("error",()=>{n("Unable to load Audio from "+t)})})}}(["/asset/sfx/advance.mp3","/asset/sfx/click.mp3","/asset/sfx/fail.mp3","/asset/sfx/game_over.mp3"].slice()),q=function(t){const e=new Map;return n=>{if(e.has(n))return e.get(n);const i=t(n);return e.set(n,i),i}}(t=>{switch(t){case"easy":return j.get("/asset/word_3.txt");case"medium":return[...j.get("/asset/word_3.txt"),...j.get("/asset/word_4.txt")].sort();case"hard":return[...j.get("/asset/word_4.txt"),...j.get("/asset/word_5.txt")].sort();case"very_hard":return[...j.get("/asset/word_5.txt"),...j.get("/asset/word_6.txt")].sort()}}),X=A(Promise.all([U.promise,j.promise,F.promise])),V=new WeakMap;function J(t){switch(t){case localStorage:return"localStorage";case sessionStorage:return"sessionStorage";default:return"<unknown Storage>"}}const Q={parse:t=>{const e=Number.parseInt(t,10);return Number.isNaN(e)?null:e},stringify:t=>t.toString()},Z=new class{constructor(t,e){this.storage=t,this.converters=e;const n=function(t){if(V.has(t))return V.get(t);const e=new Set;return V.set(t,e),e}(t);for(const i of Object.keys(e)){if(n.has(i))throw new Error(`the key "${i}" from ${J(t)} is already taken.`);n.add(i)}}getItem(t){const e=this.storage.getItem(t);return null==e?null:this.converters[t].parse(e)}hasItem(t){return null!=this.getItem(t)}setItem(t,e){this.storage.setItem(t,this.converters[t].stringify(e))}removeItem(t){this.storage.removeItem(t)}setDefaults(t){for(const e of Object.keys(t))this.hasItem(e)||this.setItem(e,t[e])}}(localStorage,{theme:(tt=["dark","light"],{parse:t=>tt.includes(t)?t:null,stringify:t=>t}),highscore_easy:Q,highscore_medium:Q,highscore_hard:Q,highscore_veryHard:Q});var tt,et;let nt;function it(t){Z.setItem("theme",t),"dark"===t?(document.body.style.backgroundColor="black",nt="dark",T.setColor("#222"),b.setColor(P),R.setColor(N)):(document.body.style.backgroundColor="white",nt="light",T.setColor(P),b.setColor(Y),R.setColor(O))}it(null!==(et=Z.getItem("theme"))&&void 0!==et?et:"light");let st=class extends p{constructor(t={}){super(t),this.source=t.source;const{imageScaling:e}=t;this.imageScaling=null!=e?e:"fit"}draw(t,e=!0){if(!this.visible)return;super.draw(t,!1),this.updateBound();const{source:n,imageScaling:i}=this;if(!n)return;const{naturalWidth:s,naturalHeight:o}=n,{x:r,y:h,width:a,height:d}=this;if("fit"===i){const e=a/s,i=d/o,c=Math.min(e,i),l=c*s,u=c*o;t.drawImage(n,r+(a-l)/2,h+(d-u)/2,l,u)}e&&this.drawChildren(t)}};class ot extends g{constructor(t={}){super(t),this.updateRadius=e,this.radius=0,this.setRadius(t)}setRadius(t){this.updateRadius=function(t){if("number"==typeof t)return function(){this.radius=t};const{updateRadius:e}=t;if(e)return e;const{radius:n=0,isRadiusRelative:i=!0}=t;return function(){if(i){const{width:t,height:e}=this;this.radius=Math.min(t,e)*n}else this.radius=n}}(t)}draw(t,e=!0){if(!this.visible)return;super.draw(t,!1),this.updateBound(),this.updateRadius();const{radius:n,x:i,y:s,width:o,height:r}=this,h=i+o/2,a=s+r/2,d=i+o,c=s+r;t.beginPath(),t.moveTo(h,s),t.arcTo(d,s,d,a,n),t.lineTo(d,a),t.arcTo(d,c,h,c,n),t.lineTo(h,c),t.arcTo(i,c,i,a,n),t.lineTo(i,a),t.arcTo(i,s,h,s,n),t.closePath(),t.fill(),t.stroke(),e&&this.drawChildren(t)}}class rt extends p{constructor(t={}){super(t),this.updateSize=e,this.size=10;const{style:n,weight:i,font:s,color:o,wrap:r,align:h,baseline:a,content:d}=t;this.content=null!=d?d:"",this.style=null!=n?n:"",this.weight=null!=i?i:"",this.font=null!=s?s:"sans-serif",this.align=null!=h?h:"center",this.baseline=null!=a?a:"middle",this.wrap=null!=r&&r,this.color=o instanceof c?o:new c(null!=o?o:"#000"),this.setSize(t)}setSize(t){this.updateSize=function(t){if("number"==typeof t)return function(){this.size=t};const{updateSize:e}=t;if(e)return e;const{size:n=10,isSizeRelative:i=!0}=t;return function(){this.size=i?n*this.height:n}}(t)}draw(t,e=!0){if(!this.visible)return;super.draw(t,!1),t.fillStyle=this.color.getString(),this.updateSize();let{content:n,size:i,style:s,weight:o,font:r,wrap:h,align:a,baseline:d}=this;t.textAlign=a,t.textBaseline=d,"string"==typeof r&&(r=[r]),r=r.map(t=>`"${t}"`),t.font=`${s} ${o} ${i}px ${r.join(" ")}`,this.updateBound();const{x:c,y:l,width:u,height:p}=this;let f,w;switch(a){case"left":f=c;break;case"center":f=c+u/2;break;case"right":f=c+u}switch(d){case"top":w=l;break;case"middle":w=l+p/2;break;case"bottom":w=l+p}if(h){const e=function(t,e,n){const i=[];for(const s of e.trim().split(ht)){const e=s.trim().split(at);let[o,...r]=e;for(const e of r){let s=`${o} ${e}`;const{width:r}=t.measureText(s);r<n?o=s:(i.push(o),o=e)}i.push(o)}return i}(t,n,u),s=e.length;switch(d){case"middle":w-=s*i/2;break;case"bottom":w-=s*i}for(let n=0;n<s;n++)t.fillText(e[n],f,w+i*n)}else t.fillText(n,f,w);e&&this.drawChildren(t)}}const ht=/\r\n|\r|\n/,at=/\s+/;const dt=i(),ct=new p({entranceParent:W,enterOption:{updateBound:function(){vt.call(this),this.y+=Math.sin((i()-dt)/2e3*Math.PI)*this.height/64}},exitOption:{x:1/12,y:-.8,width:10/12,height:.7}}),lt=new st({x:0,y:0,width:1,height:1,parent:ct}),ut=new class extends g{constructor(t={}){var e;super(t),this.path=null!==(e=t.path)&&void 0!==e?e:[]}draw(t,e=!0){if(!this.visible)return;super.draw(t,!1),this.updateBound();const{x:n,y:i,width:s,height:o,path:r}=this;if(t.beginPath(),r.length>0){const[e,...h]=r;t.moveTo(n+e[0]*s,i+e[1]*o);for(const[e,r]of h)t.lineTo(n+e*s,i+r*o);t.closePath(),t.fill(),t.stroke()}e&&this.drawChildren(t)}}({path:[[0,1],[3/4,0],[1,0],[1/4,1]],opacity:1/4,fill:P,operation:"source-atop",parent:ct});setInterval(()=>{ut.setBound({x:-1,y:0,width:1,height:1}),ut.animateBound({x:1,y:0,width:1,height:1},700,o)},4e3);const pt=new c,ft=new c,wt=new c,gt=new ot({fill:ft,line:pt,dash:[4,4],dashSpeed:.004,updateThickness:D,radius:.5,cap:"butt",join:"miter",entranceParent:W,enterOption:{x:1/6,y:.7,width:4/6,height:.1},exitOption:{x:1/6,y:1,width:4/6,height:.1}});new rt({x:0,y:0,width:1,height:1,weight:"bold",font:"ComicNeue Angular",color:wt,size:.6,content:"simulan",parent:gt});const mt=new p({x:0,y:0,width:1,height:.1,entranceParent:W}),yt=new p({x:0,y:0,width:1/6,height:1,parent:mt}),xt=new st({x:1/6,y:1/6,width:4/6,height:4/6,parent:yt}),vt=f({x:1/12,y:0,width:10/12,height:.7});function Ct(){"dark"===nt?(pt.setColor(B),ft.setColor(T),wt.setColor(B),lt.source=U.get("/asset/title_dark.png")):(pt.setColor(b),ft.setColor(B),wt.setColor(Y),lt.source=U.get("/asset/title.png"))}const St=new p({entranceParent:W,enterOption:{x:0,y:.2,width:1,height:.8},exitOption:{x:1,y:.2,width:1,height:.8}}),Tt=[{name:"madali",description:"3 pantig",difficultyKey:"easy",highscoreKey:"highscore_easy"},{name:"katamtaman",description:"3-4 pantig",difficultyKey:"medium",highscoreKey:"highscore_medium"},{name:"mahirap",description:"4-5 pantig",difficultyKey:"hard",highscoreKey:"highscore_hard"},{name:"mas mahirap",description:"5-6 pantig",difficultyKey:"very_hard",highscoreKey:"highscore_veryHard"}],bt=new Map,Rt=new Map;for(let t=0;t<Tt.length;t++){const{name:e,description:n,difficultyKey:i,highscoreKey:s}=Tt[t],o=new p({x:0,y:t/4,width:1,height:1/4}),r=new ot({x:1/16,y:1/16,width:.875,height:.875,radius:1/8,fill:R,parent:o});new rt({x:1/16,y:0,width:.875,height:.5,size:.5,color:P,align:"left",baseline:"bottom",font:"ComicNeue Angular",weight:"bold",content:e,parent:r}),new rt({x:1/16,y:.5,width:.875,height:.5,size:.3,color:P,align:"left",baseline:"top",font:"ComicNeue Angular",content:n,parent:r});const h=new rt({x:1/16,y:0,width:.875,height:1,size:.4,color:P,align:"right",weight:"bold",font:"ComicNeue Angular",parent:r});St.addChild(o),bt.set(s,h),Rt.set(i,o)}const kt=new p({entranceParent:W,enterOption:{x:0,y:0,width:1,height:.2},exitOption:{x:0,y:-.2,width:1,height:.2}}),Pt=new c,Yt=new c;new x({x:0,y:1,width:1,height:0,line:b,dash:[4,4],dashSpeed:.002,updateThickness:D,parent:kt});const Ot=new p({x:1/3,y:0,width:1/3,height:1,parent:kt});let Nt=new ot({x:.2,y:.2,width:.6,height:.6,fill:B,radius:.2,parent:Ot});const Lt=new rt({x:0,y:0,width:1,height:1,weight:"bold",font:"ComicNeue Angular",color:Y,size:.6,content:"0",parent:Nt}),Bt=new p({x:0,y:0,width:1/3,height:1,parent:kt}),Kt=new p({x:.3,y:.3,width:.4,height:.4,parent:Bt});new S({x:0,y:0,width:1/3,height:1,fill:Yt,line:b,updateThickness:D,parent:Kt}),new S({x:2/3,y:0,width:1/3,height:1,fill:Yt,line:b,updateThickness:D,parent:Kt});const Mt=new p({x:2/3,y:0,width:1/3,height:1,parent:kt}),Wt=new rt({x:0,y:0,width:1,height:1,color:Pt,size:.4,weight:"bold",font:"ComicNeue Angular",content:":20",parent:Mt}),Dt=new p({entranceParent:W,enterOption:{x:0,y:.2,width:1,height:.8},exitOption:{x:0,y:.2,width:1,height:.8}});const It=new p,zt=new p({x:3/4,y:0,width:1/4,height:1,parent:It}),At=new c(b),_t=new rt({font:"ComicNeue Angular",weight:"bold",size:.4,color:At}),Ht=new p({x:0,y:0,width:3/4,height:1,parent:It}),Et=new c,Gt=new c,$t=new c,Ut=new c,jt=new c,Ft=new c,qt=new p({x:0,y:.6,width:1,height:.2,parent:zt}),Xt=new ot({x:1/8,y:1/8,width:6/8,height:6/8,dash:[2,2],dashSpeed:.002,fill:Et,line:Gt,updateThickness:D,radius:.5,parent:qt});new rt({x:0,y:0,width:1,height:1,font:"ComicNeue Angular",color:$t,size:1,content:"×",parent:Xt});const Vt=new p({x:0,y:.8,width:1,height:.2,parent:zt}),Jt=new ot({x:1/8,y:1/8,width:6/8,height:6/8,dash:[2,2],dashSpeed:.002,fill:Ut,line:jt,updateThickness:D,radius:.5,parent:Vt});new rt({x:0,y:0,width:1,height:1,font:"ComicNeue Angular",color:Ft,size:1,content:"-",parent:Jt});class Qt extends u{constructor(){super(...arguments),this.stopped=!1,this.paused=!1,this.startTime=i(),this.pauseStartTime=NaN,this.pauseTime=0,this.timeWhenPaused=0}get time(){return this.paused?this.timeWhenPaused:i()-this.startTime-this.pauseTime}pause(){this.paused||(this.timeWhenPaused=this.time,this.pauseStartTime=i(),this.paused=!0,this.invoke("pause"))}play(){!this.stopped&&this.paused&&(this.pauseTime+=i()-this.pauseStartTime,this.paused=!1,this.invoke("play"))}toggle(){this.paused?this.play():this.pause()}stop(){this.pause(),this.stopped=!0,this.invoke("stop")}timeout(t){return new Promise((e,n)=>{let i=-1,s=this.time,o=t;const r=()=>{this.off("play",h),this.off("pause",a)},h=()=>{i=setTimeout(()=>{r(),e()},o)},a=()=>{o-=this.time-s,s=this.time,clearTimeout(i)};this.paused||h(),this.on("play",h),this.on("pause",a),this.once("stop",()=>{r(),n()})})}}const Zt=E("B BL BR BW BY\nK KL KR KW KY\nD DR DY\nG GL GR GW\nH\nL\nM MY\nN NY\nŊ\nP PL PR PY\nR\nS SH SW\nT TR TS TY\nW\nY");Zt.add("");const te=E("B\nK KS\nD DS\nG\nL LD LM LP LS LT\nM MP MS\nN ND NK NKS NS NT\nŊ ŊS\nP PS\nR RB RD RK RM RN RP RS RT\nS SH SK SM ST\nT TS\nW WG WN\nY YK YL YM YN YR YS YT");te.add("");const ee=new Map("B/L\n/BR\nB/W\nB/Y\n/DR\nD/S\nD/SH\nD/SW\nD/Y\nG/L\nG/R\nG/W\nK/L\n/KR\nK/S\nK/SH\nK/SW\nK/W\nK/Y\nL/D\nL/DR\nL/DY\nL/M\nL/MY\nL/P\nL/PL\nL/PR\nL/PY\nL/S\nL/SH\nL/SW\nL/T\nL/TR\nLT/S\nLT/Y\nM/P\nM/PL\nM/PR\nM/PY\nM/S\nM/SH\nM/SW\nM/Y\nN/D\nN/DR\nN/DY\nN/K\nN/KL\nN/KR\nNK/S\nNK/SH\nNK/SW\nN/KW\nN/KY\nN/S\nN/SH\nN/SW\nN/T\nN/TR\nN/TS\nN/TY\nN/Y\nŊ/S\nŊ/SH\nŊ/SW\nP/L\n/PR\nP/S\nP/SH\nP/SW\nP/Y\nR/B\nR/BL\nR/BR\nR/BW\nR/BY\nR/D\nR/DR\nR/DY\nR/K\nR/KL\nR/KR\nR/KW\nR/KY\nR/M\nRM/Y\nR/N\nRN/Y\nR/P\nR/PL\nR/PR\nR/PY\nR/S\nR/SH\nR/SW\nR/T\nR/TR\nRT/S\nRT/Y\n/SH\nS/K\nS/KL\nS/KR\nS/KW\nS/KY\nS/M\nS/MY\nS/T\nS/TR\nST/S\nST/Y\nS/W\n/TR\n/TS\nT/SH\nT/SW\nT/Y\nW/G\nW/GL\nW/GR\nW/GW\nW/N\nW/NY\nY/K\nY/KL\nY/KR\nY/KW\nY/KY\nY/L\nY/M\nY/MY\nY/N\nY/NY\nY/R\nY/S\nY/SH\nY/SW\nY/T\nY/TR\nY/TS\nY/TY".trim().split(H).map(t=>{const e=t.trim().split("/").map(t=>t.trim());if(e.length<2)throw new Error("invalid source");return[e.join(""),e]}));function ne(t){if(t.length<=0)return["",""];if(t.length<=1)return["",t];if(ee.has(t))return ee.get(t);for(let e=0;e<=t.length;e++){const n=t.slice(0,e),i=t.slice(e);if(Zt.has(i)&&te.has(n)){const e=[n,i];return ee.set(t,e),e}}throw new Error("unable to split "+t)}const ie=/(\-)/,se=/([AEIOU])/,oe=/NG/g,re=/Ŋ/g;function he(t){const e=(t=t.toUpperCase().replace(oe,"Ŋ")).split(se),n=[e[0]];for(const t of e.slice(1,-1)){if(se.test(t)){n.push(t);continue}const[e,i]=ne(t);n.push(e),n.push(i)}n.push(e[e.length-1]);const i=[];for(let t=0;t<n.length;t+=3)i.push(n.slice(t,t+3).join("").replace(re,"NG"));return i}class ae{constructor(t,e){this.parentTwist=t,this.syllable=e,this.pressed=!1}unpress(){let{parentTwist:{formed:t},pressed:e}=this;this.pressed=!1,e&&t.splice(t.indexOf(this),1)}press(){let{parentTwist:{formed:t},pressed:e}=this;this.pressed=!0,e||t.push(this)}}class de{constructor(t){this.parentTwist=t,this.syllable="-"}unpress(){const{parentTwist:{formed:t}}=this;t.splice(t.indexOf(this),1)}}class ce{constructor(t){this.sourceBank=t,this.blocks=[],this.formed=[];const e=t[Math.floor(Math.random()*t.length)];this.sourceWord=e.toLowerCase();const n=function(t){const e=[];for(const n of t.split(ie))if("-"!==n)for(const t of he(n))e.push(t);else e.push("-");return e}(e).filter(t=>"-"!==t);n.sort(()=>Math.random()-Math.random());for(const t of n)this.blocks.push(new ae(this,t.toLowerCase()))}press(t){var e;null===(e=this.blocks[t])||void 0===e||e.press()}clear(){for(const t of[...this.formed])t.unpress()}addHyphen(){this.lastBlock instanceof de||this.formed.push(new de(this))}get isFilled(){return this.blocks.length-this.formed.filter(t=>t instanceof ae).length<=0}get formedWord(){return this.formed.map(t=>t.syllable).join("")}get isValid(){const{isFilled:t,formedWord:e,sourceWord:n,sourceBank:i}=this;return t&&(e===n||i.includes(e.toUpperCase()))}get lastBlock(){let{formed:t}=this;return t[t.length-1]}}const le=new S({x:0,y:0,width:1,height:1,fill:new c({red:0,green:0,blue:0,alpha:.5}),entranceParent:M}),ue=new v({ratio:.6,opacity:1,parent:le}),pe=new ot({fill:T,radius:1/16,entranceParent:ue,enterOption:{x:1/6,y:.3,width:4/6,height:.4},exitOption:{x:1/6,y:1,width:4/6,height:.4}});let fe=new p({x:0,y:6/8,width:1,height:2/8,parent:pe});const we=new c,ge=new c,me=new c,ye=new c(P),xe=new rt({x:1/8,y:0,width:6/8,height:6/8,wrap:!0,align:"left",baseline:"middle",font:"ComicNeue Angular",size:1/9,color:b,parent:pe}),ve=new ot({x:0,y:0,width:.5,height:1,radius:1/4,fill:we,parent:fe}),Ce=new rt({x:0,y:0,width:1,height:1,size:.4,color:ge,font:"ComicNeue Angular",weight:"bold",parent:ve}),Se=new ot({x:.5,y:0,width:.5,height:1,radius:1/4,fill:me,parent:fe}),Te=new rt({x:0,y:0,width:1,height:1,size:.4,color:ye,font:"ComicNeue Angular",weight:"bold",parent:Se});function be(e,i,s){return t(this,0,void 0,(function*(){me.setColor(R),we.setColor(T),ge.setColor(b),le.fadeIn(),pe.enter(),xe.content=e,Te.content=i,Ce.content=s;const t=yield Promise.race([z(Se.once("interactup"),!0),z(ve.once("interactup"),!1)]);return le.fadeOut(),pe.exit(),yield n(200),t}))}Se.on("interactdown",()=>{me.setColor(T),ye.setColor(b)}),Se.on("interactup",()=>{me.setColor(R),ye.setColor(P)}),ve.on("interactdown",()=>{we.setColor(L),ge.setColor(P)}),ve.on("interactup",()=>{we.setColor(T),ge.setColor(b)});const Re=new S({x:0,y:0,width:1,height:1,fill:T,entranceParent:M}),ke=new v({ratio:.6,parent:Re});new rt({x:0,y:.3,width:1,height:.2,font:"ComicNeue Angular",weight:"bold",size:.5,content:"nakahinto",color:b,parent:ke});const Pe=new p({x:0,y:.8,width:1,height:.2,parent:ke}),Ye=new p({x:0,y:.5,width:1,height:.5,parent:Pe});new ot({x:1/8,y:0,width:6/8,height:1,fill:R,radius:.5,parent:Ye}),new rt({x:0,y:0,width:1,height:1,font:"ComicNeue Angular",weight:"bold",size:.5,content:"ipagpatuloy",color:P,parent:Ye});const Oe=new p({x:0,y:0,width:1,height:.5,parent:Pe});let Ne;new rt({x:0,y:0,width:1,height:1,font:"ComicNeue Angular",weight:"bold",size:.5,content:"bumalik",color:b,parent:Oe}),qt.on("interactdown",()=>{$t.setColor(Y)}),Vt.on("interactdown",()=>{Ft.setColor(Y)}),Bt.on("interactdown",()=>{Ne.paused||Yt.setColor(N)}),Bt.on("interactup",()=>{Ne.paused||(Yt.setColor(T),function(){t(this,0,void 0,(function*(){Ne.pause();(yield function(){return t(this,0,void 0,(function*(){for(yield Re.fadeIn();;){if(yield Promise.race([z(Ye.once("interactup"),!0),z(Oe.once("interactup"),!1)]))return yield Re.fadeOut(),!0;if(!(yield be("Sigurado kang gusto mong itigil ang laro at bumalik?","Ituloy","Itigil")))return yield Re.fadeOut(),!1}}))}())?Ne.play():(Ne.stop(),Ae(),Ge(),ze())}))}())});let Le=0;let Be,Ke,Me,We;function De(){return t(this,0,void 0,(function*(){const e=new ce(We),s=e.sourceWord;yield function(e){return t(this,0,void 0,(function*(){!function(){At.setColor(b),Et.setColor(T),Gt.setColor(L),$t.setColor(L),Ut.setColor(R),jt.setColor(k),Ft.setColor(P),He&&qt.off("interactup",He);Ee&&Vt.off("interactup",Ee);_t.content="",_t.addTo(Dt),_t.setBound({x:1,y:0,width:1,height:1/4}),_t.animateBound({x:0,y:0,width:1,height:1/4},400,a),It.addTo(Dt),It.setBound({x:1,y:1/4,width:.8,height:3/4}),It.animateBound({x:.1,y:1/4,width:.8,height:3/4},400,a)}();const n=[],i=[],s=[];He=()=>{if(!Ne.paused){e.clear(),_t.content=e.formedWord;for(const t of n)t.setColor(k);for(const t of i)t.setColor(R);for(const t of s)t.setColor(P);Et.setColor(T),Gt.setColor(L),$t.setColor(L),Ut.setColor(R),jt.setColor(k),Ft.setColor(P)}},qt.on("interactup",He),Ee=()=>{Ne.paused||(e.addHyphen(),_t.content=e.formedWord,Et.setColor(L),Gt.setColor(k),$t.setColor(P),Ut.setColor(T),jt.setColor(R),Ft.setColor(R))},Vt.on("interactup",Ee);const{blocks:o}=e;for(let r=0;r<o.length;r++){const h=o[r],{syllable:a}=h,d=new c(k),l=new c(R),u=new c(P);n.push(d),i.push(l),s.push(u);let f,w,g=1,m=0;length>=6&&r>3&&(g=2/3,r>4&&(m=2/3)),length>=6&&r>4?(f=.875,w=1/16):(f=46/48,w=1/48);let y=(4-r)/5;r>4&&(y=0);const x=new p({x:m,y,width:g,height:.2,parent:Ht});x.on("interactdown",()=>{Ne.paused||u.setColor(Y)}),x.on("interactup",()=>t(this,0,void 0,(function*(){Ne.paused||(d.setColor(R),l.setColor(T),u.setColor(R),Et.setColor(L),Gt.setColor(k),$t.setColor(P),Ut.setColor(R),jt.setColor(k),Ft.setColor(P),e.press(r),_t.content=e.formedWord,e.isFilled&&(e.isValid?Ie(Ge()):(At.setColor("#f00"),yield At.animateColor("#f000",200),null==He||He(),At.setColor(b))))})));const v=new ot({x:w,y:1/8,width:f,height:6/8,dash:[2,2],dashSpeed:.004,fill:l,line:d,updateThickness:D,radius:.5,parent:x});new rt({x:0,y:0,width:1,height:1,font:"ComicNeue Angular",weight:"bold",color:u,size:.6,content:a,parent:v})}}))}(e);const o=Ke,r=Ne.time;let h;Be=()=>{if(Ne.stopped)return;const t=Math.ceil(20+(r-Ne.time)/1e3);Wt.content=":"+t.toString().padStart(2,"0"),t!==h&&t<=5&&(Pt.setColor("#f00"),Pt.animateColor(b,1e3)),h=t},M.on("frame",Be),yield Ne.timeout(2e4),o===Ke&&(yield function(e){return t(this,0,void 0,(function*(){Ne.stop(),M.off("frame",Be),Wt.content=":O",yield function(){return t(this,0,void 0,(function*(){const t=Dt.updateBound,e=i();Dt.updateBound=function(){t.call(this);const{x:n,width:s}=this,o=(i()-e)/500-1;this.x=n+Math.sin(8*o*Math.PI)*o*s/8},yield n(500),Dt.updateBound=t}))}(),yield n(500),Ae(),Wt.content=":(",Ge();(yield function(e,n){return t(this,0,void 0,(function*(){const t=`Tamang Sagot: ${e}\nPuntos: ${n}\nSimulan muli?`;return yield be(t,"Oo","Hindi")}))}(e,Le))?(Ne=new Qt,_e(),De()):ze()}))}(s))}))}function Ie(e){return t(this,0,void 0,(function*(){Le++,Lt.content=Le.toString(),M.off("frame",Be),Wt.content=":D",Ke=Symbol(),e&&(yield e),De()}))}function ze(){return t(this,0,void 0,(function*(){_e(),yield kt.exit(),yield n(200),Dt.remove(),Ue()}))}function Ae(){var t;(null!==(t=Z.getItem(Me))&&void 0!==t?t:0)<Le&&Z.setItem(Me,Le)}function _e(){Le=0,Lt.content="0"}window.addEventListener("beforeunload",Ae);let He=null,Ee=null;function Ge(){return t(this,0,void 0,(function*(){_t.animateBound({x:-1,y:0,width:1,height:1/4},200,h),It.animateBound({x:-1,y:1/4,width:1,height:3/4},200,h),yield n(200),Ht.removeAllChildren(),_t.remove(),It.remove()}))}for(const e of Tt){const{difficultyKey:n,highscoreKey:i}=e;Rt.get(n).on("interactup",()=>t(void 0,0,void 0,(function*(){var t,e;yield $e(),t=i,e=q(n),Me=t,We=e,Pt.setColor(b),Yt.setColor(T),Ne=new Qt,kt.enter(),Dt.enter(),Wt.content=":20",De()})))}function $e(){return t(this,0,void 0,(function*(){yield St.exit()}))}function Ue(){Ct(),xt.source=U.get("/asset/bulb.png"),ct.enter(),gt.enter(),mt.fadeIn()}gt.on("interactup",()=>t(void 0,0,void 0,(function*(){yield function(){return t(this,0,void 0,(function*(){gt.exit(),ct.exit(),mt.fadeOut(),yield n(200)}))}(),function(){for(const[t,e]of bt)e.content=""+Z.getItem(t);St.enter()}()}))),yt.on("interactup",()=>{it("dark"===nt?"light":"dark"),Ct()}),Z.setDefaults({theme:"light",highscore_easy:0,highscore_medium:0,highscore_hard:0,highscore_veryHard:0}),function(e){return t(this,0,void 0,(function*(){yield I.enter(),yield e,yield I.exit(),I.remove()}))}(X).then(()=>{Ue()})}();
